var ep = window.ep || {}; ep.bundles = ep.bundles || []; ep.bundles = ep.bundles.concat('bundled/ehost/result_list.js','ep/webservices/common.js', 'ep/webservices/folderwebservice.js', 'ep/webservices/pendingsearchtabservice.js', 'ep/extension/number.js', 'ep/ajaxcallback.js', 'ep/ajaxupdatefolder.js', 'ep/ajaxresultlist.js', 'ep/eprelatedinfoexternalitem.js', 'ep/eprelatedinfoexternalbehavior.js', 'ep/eprecordpreviewhover.js', 'ep/dualslider.js', 'ep/controller/control/clustercontrol.js', 'ep/controller/control/doctypecontrol.js', 'ep/controller/control/imagequickview.js', 'ep/controller/control/relatedinfocontrol.js', 'ep/controller/control/limitsyourresultscontrol.js', 'ep/controller/control/folderitemscontrol.js', 'ep/base/resultlistcontroller.js', 'ep/widgets/simpleaccordion.js', 'ep/common/alertemailed.js', 'ep/jqueryplugins/absolutize.js', 'ep/base/modaldialogcontroller.js', 'ep/base/modalpanelcontroller.js', 'ep/base/selectmultiplecontroller.js', 'ep/controller/control/breadboxcontrol.js', 'ep/controller/page/ehost/resultlistcontroller.js', 'ep/controller/control/bookjackets.js');
(function(b){if(window.EPWebServices===undefined){window.EPWebServices={}}EPWebServices.buildURL=function(h,f){h=h.replace(/^\//,"");f=f.replace(/^\//,"");var a=(this._getHid()!==null)?"?hid="+this._getHid():"";var g=location.href.split("/"+ep.interfaceId+"/")[0]+"/"+h+"/"+f+a;return g};EPWebServices.doWebServiceCall=function(h,i,k,j,l){ep.debug("ep/webservices/common.js -> doWebServiceCall");var a=b.ajax(h,{type:"POST",contentType:"application/json",data:JSON.stringify(i),dataType:"text",success:function(c,d,g){var n;var e=g.getResponseHeader("content-type")||"";if(e.indexOf("json")>-1){var f=b.parseJSON(c);if(f!==null){n=f.d}}else{n=c}if(k){k(n,l)}},error:function(e,c,d){ep.debug("ajax error : "+d);if(j){j(transport.responseText,l)}}})};EPWebServices._getHid=function(){var a=window.location.toString().match(/hid=(\d+)/);if(a!==null&&a.length>1){return a[1]}else{return null}}})(jQuery);EPWebServices.FolderWebService={};EPWebServices.FolderWebService._SERVICE_URL="/Legacy/Views/WebServices/FolderWebService.asmx";EPWebServices.FolderWebService.FolderPageAddRemove=function(k,m,q,n,o,p,j){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageAddRemove");var r={theSessionParams:k,theContentItem:m,theIsAdd:q,theIsRefreshFolderItems:n};EPWebServices.doWebServiceCall(l,r,o,p,j)};EPWebServices.FolderWebService.FolderItemsAddRemove=function(k,m,q,n,o,p,j){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderItemsAddRemove");var r={theSessionParams:k,theContentItem:m,theIsAdd:q,theIsRefreshFolderItems:n};EPWebServices.doWebServiceCall(l,r,o,p,j)};EPWebServices.FolderWebService.DAFolderItemsAddRemove=function(k,m,q,n,o,p,j){var l=EPWebServices.buildURL(this._SERVICE_URL,"DAFolderItemsAddRemove");var r={theSessionParams:k,theContentItem:m,theIsAdd:q,theIsRefreshFolderItems:n};EPWebServices.doWebServiceCall(l,r,o,p,j)};EPWebServices.FolderWebService.AddExternalFolderItems=function(g,j,i,l){var h=EPWebServices.buildURL(this._SERVICE_URL,"AddExternalFolderItems");var k={theContentItems:g};EPWebServices.doWebServiceCall(h,k,j,i,l)};EPWebServices.FolderWebService.RemoveExternalFolderItem=function(h,k,j,g){var i=EPWebServices.buildURL(this._SERVICE_URL,"RemoveExternalFolderItem");var l={theContentItems:h};EPWebServices.doWebServiceCall(i,l,k,j,g)};EPWebServices.FolderWebService.FolderItemsRefresh=function(m,p,q,l){var k=EPWebServices.buildURL(this._SERVICE_URL,"FolderItemsRefresh");var s={theSessionParams:m};var r=window.panelLoadState||{};if(r.right){ep.showPanel("rightCollapsible","PanelContainer")}else{var t=getElementById("rightCollapsiblePostBack");if(t){var n=/javascript:\s*__doPostBack\s*\(\s*'([^']+)/;var o=n.exec(t.href);if(o){__doPostBack(o[1],"")}}}EPWebServices.doWebServiceCall(k,s,p,q,l)};EPWebServices.FolderWebService.FolderReadNote=function(k,j,m,l,h){var i=EPWebServices.buildURL(this._SERVICE_URL,"FolderReadNote");var n={theSessionParams:k,theContentItem:j};EPWebServices.doWebServiceCall(i,n,m,l,h)};EPWebServices.FolderWebService.FolderPageNoteAdd=function(n,o,p,s,k,q,r,m){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteAdd");var t={theSessionParams:n,theContentItem:o,theIsRefreshFolderItems:p,theIsArticleNote:s,theIsInViewer:k};EPWebServices.doWebServiceCall(l,t,q,r,m)};EPWebServices.FolderWebService.FolderPageNoteDelete=function(m,n,o,j,p,q,k){var l=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteDelete");var r={theSessionParams:m,theContentItem:n,theIsRefreshFolderItems:o,theIsInViewer:j};EPWebServices.doWebServiceCall(l,r,p,q,k)};EPWebServices.FolderWebService.FolderPageNoteUpdate=function(l,m,n,j,o,q,k){var p=EPWebServices.buildURL(this._SERVICE_URL,"FolderPageNoteUpdate");var r={theSessionParams:l,theContentItem:m,theIsRefreshFolderItems:n,theIsInViewer:j};EPWebServices.doWebServiceCall(p,r,o,q,k)};EPWebServices.PendingSearchTabService={};EPWebServices.PendingSearchTabService._SERVICE_URL="/Views/WebServices/PendingSearchTabService.asmx";EPWebServices.PendingSearchTabService.ResolvePendingTabs=function(i,l,k,n,m,p){var j=EPWebServices.buildURL(this._SERVICE_URL,"ResolvePendingTabs");var o={theSessionID:i,theVersionID:l,theTabIDs:k};EPWebServices.doWebServiceCall(j,o,n,m,p)};Number.prototype.px=function(){return parseInt(this,10)+"px"};Number.isNumeric=function(b){return !isNaN(parseFloat(b))&&isFinite(b)};Number.numOrDefault=function(c,d){return ep.utilities.isNumeric(c)?c:(d||0)};var aOriginalActionPage=null;var aNativePostBack;function __doNativePostBack(h,g){window.ClearTarget();var f=getPostBackForm();var j=aOriginalActionPage;var i=getUpdatedFormAction(f,j);f.action=i;aNativePostBack(h,g)}function UpdatePostBack(){if(typeof(__doPostBack)==="function"){aOriginalActionPage=getPostBackPage(getPostBackForm(),false);aNativePostBack=__doPostBack;__doPostBack=__doNativePostBack}}jQuery(document).ready(UpdatePostBack);function AjaxCallBack(){this.XmlHttp=getXmlHttpObject();this.eventTarget=null;this.eventArgument=null;this.readyState=(this.XmlHttp&&(this.XmlHttp.readyState===0||this.XmlHttp.readyState===4));this.redirect=null;this.autoRedirect=true}AjaxCallBack.prototype.doPostBack=function(l,p){var o=getPostBackForm();var i=getPostBackPage(o,false);var j="__EVENTTARGET="+escape(l.split("$").join(":"))+"&";j+="__EVENTARGUMENT="+p+"&";j+="__VIEWSTATE="+escape(o.__VIEWSTATE.value).replace(new RegExp("\\+","g"),"%2b")+"&";j+="__CUSTOMVIEWSTATE="+escape(o.__CUSTOMVIEWSTATE.value).replace(new RegExp("\\+","g"),"%2b")+"&";j+="IsCallBack=true&";var k="";for(var n=0;n<o.elements.length;n++){k=o.elements[n].name;if(k&&k!==""){if(k!=="__EVENTTARGET"&&k!=="__EVENTARGUMENT"&&k!=="__VIEWSTATE"&&k!=="__CUSTOMVIEWSTATE"){j=j+escape(k.split("$").join(":"))+"="+o.elements[n].value;if(n!==o.elements.length-1){j=j+"&"}}}}if(this.XmlHttp){if(this.XmlHttp.readyState===4||this.XmlHttp.readyState===0){this.readyState=true}else{this.readyState=false}if(this.readyState){var m=this;this.XmlHttp.open("POST",i,true);this.XmlHttp.onreadystatechange=function(){m.ReadyStateChange()};this.XmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.XmlHttp.send(j)}this.eventTarget=l;this.eventArgument=p}};AjaxCallBack.prototype.doCallBack=function(i,k,p){var o=getPostBackForm();var n=(!i)?getPostBackPage(o,true):i;var l=getUpdatedFormAction(o,n);var j="__EVENTTARGET="+k+"&";j+="IsCallBack=true&";j+=this.serializeFormData(o);if(p.indexOf("&")>-1){j+=p+"&"}else{j+="__EVENTARGUMENT="+p+"&"}if(this.XmlHttp){if(this.XmlHttp.readyState===4||this.XmlHttp.readyState===0){this.readyState=true}else{this.readyState=false}if(this.readyState){var m=this;this.XmlHttp.open("POST",l,true);this.XmlHttp.onreadystatechange=function(){m.ReadyStateChange()};this.XmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.XmlHttp.send(j)}this.eventTarget=k;this.eventArgument=p}};AjaxCallBack.prototype.OnLoading=function(){};AjaxCallBack.prototype.OnLoaded=function(){};AjaxCallBack.prototype.OnInteractive=function(){};AjaxCallBack.prototype.OnComplete=function(){};AjaxCallBack.prototype.OnAbort=function(){};AjaxCallBack.prototype.OnError=function(){};AjaxCallBack.prototype.AbortCallBack=function(){if(this.XmlHttp){this.XmlHttp.abort()}};AjaxCallBack.prototype.ReadyStateChange=function(){if(this.XmlHttp.readyState===0){this.readyState=true}if(this.XmlHttp.readyState===1){this.readyState=false;this.OnLoading()}else{if(this.XmlHttp.readyState===2){this.readyState=false;this.OnLoaded()}else{if(this.XmlHttp.readyState===3){this.readyState=false;this.OnInteractive()}else{if(this.XmlHttp.readyState===4){this.readyState=true;var d=this.XmlHttp.statusText;if(this.XmlHttp.status===0){this.OnAbort()}else{if(this.XmlHttp.status===200&&(!d||this.XmlHttp.statusText==="OK")){try{if(this.XmlHttp.getResponseHeader("vid")!==""){getPostBackForm().action=getFormActionWithUpdatedVID(getPostBackForm(),aOriginalActionPage,this.XmlHttp.getResponseHeader("vid"))}this.redirect=this.XmlHttp.getResponseHeader("redirect");if(this.autoRedirect){this.redirectToPage(this.redirect)}}catch(c){}this.OnComplete(this.XmlHttp.responseText,this.XmlHttp.responseXML,this.eventTarget,this.eventArgument)}else{this.OnError(this.XmlHttp.status,this.XmlHttp.statusText,this.XmlHttp.responseText)}}}}}}};AjaxCallBack.prototype.redirectToPage=function(f,h){if(f){var g=getPostBackForm();var e=getUpdatedFormAction(g,f);if(h!==undefined){e=e+h}window.location=e}};AjaxCallBack.prototype.serializeFormData=function(i){var l,j,n;var k="";this.add=function(a,b){k+=a+"="+encodeURIComponent(b)+"&"};for(var m=0;m<i.elements.length;m++){l=i.elements[m];j=getClientId(l.getAttribute("id"),"_");n=getClientId(l.getAttribute("name"),"$");if(!l.disabled){switch(l.type){case"hidden":if(n!=="__EVENTTARGET"&&n!=="__EVENTARGUMENT"&&n!=="__VIEWSTATE"&&n!=="__CUSTOMVIEWSTATE"&&n!=="__LASTFOCUS"){this.add(n,l.value)}break;case"text":case"textarea":case"password":this.add(j,l.value);break;case"checkbox":this.add(j,l.checked);break;case"radio":if(l.checked){this.add(n,l.value)}break;case"select-one":if(l.options[l.selectedIndex].value!==""){this.add(j,l.options[l.selectedIndex].value)}break;case"select-multiple":for(var h=0;h<l.options.length;h++){if(l.options[h].selected){this.add(j,l.options[h].value)}}break}}}return k};var aFolderItemID="";var aAjaxUpdateFolderIsFolderAdd=false;function SucceededCallback(d,f,e){if(aFolderItemID){ep.folder.swapItemStyle(aFolderItemID,false,aAjaxUpdateFolderIsFolderAdd)}else{window.SwapAllStyles()}}function FailedCallback(d,f,e){}function FolderItems_Toggle(f,d){aFolderItemID=f;aAjaxUpdateFolderIsFolderAdd=d;var e=new this.ep.folder.FolderItems();e.Add(window.BuildExternalFolderItem(f,true));if(d){if(e.Count()>0){if(typeof EPWebServices.FolderWebService!=="undefined"){EPWebServices.FolderWebService.AddExternalFolderItems(e.Clone(),SucceededCallback,FailedCallback)}}}else{if(e.Count()>0){if(typeof EPWebServices.FolderWebService!=="undefined"){EPWebServices.FolderWebService.RemoveExternalFolderItem(e.Clone(),SucceededCallback,FailedCallback)}}}}ep.folder.FolderItems=function(){var b=0;this.Add=function(a){if(!a){return}b++;this[(b-1)]=a};this.Remove=function(a){if(a<0||a>this.length-1){return}this[a]=null;for(var d=a;d<=b;d++){this[d]=this[d+1]}b--};this.Count=function(){return b};this.Clear=function(){for(var a=0;a<b;a++){this[a]=null}b=0};this.Clone=function(){var d=new ep.folder.FolderItems();for(var a=0;a<b;a++){d.Add(this[a])}return d}};ep.folder.ExternalFolderItem=function(){this.ID="";this.Source="";this.Url="";this.Title="";this.Descr=""};ep.folder.ExternalFolderItemWithSID=function(){this.ID="";this.Source="";this.Url="";this.Title="";this.Descr="";this.SID="";this.VID=""};function BuildExternalFolderItem(d,f){var e=null;if(f){e=new ep.folder.ExternalFolderItemWithSID();e.SID=document.getElementById("__sid").value;e.VID=document.getElementById("__vid").value}else{e=new ep.ExternalFolderItem()}e.ID=document.getElementById("rec_id_"+d).value;e.Source=document.getElementById("rec_source_"+d).value;e.Url=document.getElementById("rec_link_"+d).href;e.Title=document.getElementById("rec_link_"+d).innerHTML;e.Descr=document.getElementById("rec_descr_"+d).innerHTML;return e};var aTarget="";var isFolderAdd=false;function AjaxComplete(f,h,j,g){AjaxCallBack.prototype.OnComplete();var i=null;switch(aTarget){case"ResultList":break;case"FolderItem":ep.folder.swapItemStyle(g.substring(0,g.indexOf("_")),false,isFolderAdd);ep.folder.folderItemsRefresh();break;case"AddAll":window.SwapAllStyles();ep.folder.folderItemsRefresh();break}}function AjaxError(e,f,d){AjaxCallBack.prototype.OnError(f,d)}var aAjaxCallBack=new AjaxCallBack();if(aAjaxCallBack&&aAjaxCallBack.XmlHttp&&aAjaxCallBack.readyState){aAjaxCallBack.OnComplete=AjaxComplete;aAjaxCallBack.OnError=AjaxError}function doCallBack(c,d){if((c.indexOf("FolderItem")>-1)){aTarget="FolderItem";isFolderAdd=c.indexOf("AddItem")>-1;aAjaxCallBack.doCallBack("",c,d)}else{if(c.match(/AddAll/).length>0){aTarget="AddAll";aAjaxCallBack.doCallBack("",c,d)}else{aAjaxCallBack.AbortCallBack();_doPostBack(c,d)}}};var EPRelatedInfoExternalItem=(function(c){var d;d=function(a,b,f){this._element=a;this._itemID="";this._itemState="";if(b){this.set_itemID(b)}if(f){this.set_itemState(f)}};d.prototype={get_itemID:function(){return this._itemID},set_itemID:function(a){if(this._itemID!==a){this._itemID=a}},get_itemState:function(){return this._itemState},set_itemState:function(a){if(this._itemState!==a){jQuery(this._element).removeClass(this._itemState);this._itemState=a;jQuery(this._element).addClass(a);jQuery(this._element).children('input[name="externalitemstate"]').first().val(this._itemState)}},get_element:function(){return this._element}};return d}(jQuery));var EPRelatedInfoExternalBehavior=(function(c){var d;d=function(a){this._external_items=[];this._element=a;var b=c(a);var g=this;if(b.length){var h=b.find('div[id$="externalItem"]');if(h.length){h.each(function(n,f){var m=c(f).children('input[name="externalitemstate"]').first().val();var l=c(f).children('input[name="externalitemid"]').first().val();if(m===null){return true}var e=new EPRelatedInfoExternalItem(f,l,m);g._external_items.push(e)})}}};d.prototype={has_pending_items:function(){var a=this.get_external_items();if(a&&a.length>0){for(var b=0;b<a.length;b++){if(a[b].get_itemState()==="Pending"){return true}}}return false},has_external_items:function(){return(this.get_external_items().length>0)?true:false},get_external_items:function(){return this._external_items},set_external_items:function(a){if(this._external_items!==a){this._external_items=a;this.raisePropertyChanged("externalItems")}},get_pending_items:function(){var a=[];var b=this.get_external_items();if(b&&b.length>0){for(var f=0;f<b.length;f++){if(b[f].get_itemState()==="Pending"){a.push(b[f])}}}return a},get_element:function(){return this._element}};return d}(jQuery));(function(b){ep.dialog.RecordPreview=function(){var x={};function v(d){var c=jQuery(".json-data",d);if(!c.length){return null}var e=jQuery.parseJSON(c[0].firstChild.nodeValue);e.theHoverElement=d;return t(e,null,true)}function u(e){var k=null;var l=e+1;var g="";var f=jQuery("#hoverPreview"+l).data("hoverpreviewjson");if(f){var i=null;if(f.resultListId||f.archiveNoteItemId){i=ep.utilities.buildAjaxRequestPath("Detail/HoverPreview");g=f.resultListId}else{if(f.db&&f.tag&&f.term){i=ep.utilities.buildAjaxRequestPath("Detail/HoverPreview",{Db:f.db,Tag:f.tag,Term:f.term})}}var d=jQuery("#hoverPreview"+l).parent().parent("ol").hasClass("related-info-list");var h=jQuery("#hoverPreview"+l).attr("targetid");var j=jQuery("#hoverPreview"+l).data("reasontext");var c={theIsRelatedInfo:d,theTargetId:h,theResultListId:g,isNovList:f.isNovList};if(f.archiveNoteItemId){c.theArchiveNoteItemId=f.archiveNoteItemId}if(f.isNote){c.theIsNote=f.isNote}jQuery.ajax({url:i,data:c,async:false,success:function(m){k=t(m,e,j)}})}return k}function t(i,f,l){var m="";m+="<dl class=\"preview-detail\" data-auto='preview_detail'";if(i.ExtendedMarkupInfo&&i.ExtendedMarkupInfo!=""){m+="data-extmarkup='"+i.ExtendedMarkupInfo+"'"}m+=">";var h;var g;var e;if(i.IgnoreProperties){h="Title";g=i.DisplayValues[h];e=h;m+="<dt data-auto='preview_detail_title_hidden'";m+=' class="hidden"';m+=">"+e+":</dt><dd";m+=" data-auto='preview_detail_title' class=\"title-link\"";if(false){m+='href="'+b(i.theHoverElement).parent().find("a").attr("href")+'"'}else{m+='href="#"'}m+=">"+w(i,g,b(i.theHoverElement).parent().find("a").attr("href"))+"</dd>";i.IgnoreProperties.push("Title")}if(l){i.DisplayValues.Reason=l+i.RecommendationFeedbackTag}for(h in i.DisplayValues){if(typeof i.DisplayValues[h]!=="function"){if(n(i.IgnoreProperties,h)){continue}g=i.DisplayValues[h];if(g&&g.length>0){e=h;if(_.isArray(g)){g=q(g)}if(ep.clientData.hoverPreviewLabelData[h]){e=ep.clientData.hoverPreviewLabelData[h]}m+="<dt data-auto='preview_detail_info_label'";if(h==="Title"){m+=' class="hidden"'}m+=">"+e+":</dt><dd data-auto='preview_detail_info_value'";if(h==="Title"){m+=' class="title-link"';m+=">"+w(i,g)+"</dd>"}else{m+=">"+g+"</dd>"}}}}m+="</dl>";if(i.HeaderLinks||i.FooterLinks){m+="<div class=\"hover-links\" data-auto='preview_detail_links'>"}var k=i.HeaderLinks;if(k&&k.length>0&&i.TargetId){for(var c=0;c<k.length;c++){m+=p(i.TargetId,k[c])}}else{if(i.ResultListIndex){m+=s(i.ResultListIndex)}}if(ep.dialog.RecordPreview.isShowFolderLink){m+=o(f,i)}var z=i.FooterLinks;if(z&&z.length>0&&i.TargetId){for(var d=0;d<z.length;d++){m+=p(i.TargetId,z[d])}}else{if(i.ResultListIndex){m+=r(i.ResultListIndex,"record-type format-citation",ep.clientData.hoverPreviewLabelData.FullCitation,true);var j=document.getElementById("externalLinks"+i.ResultListIndex);if(j&&j.innerHTML&&j.innerHTML.length>0){m+='<div class="hover-external-links" data-auto="preview_detail_external_links">'+j.innerHTML+"</div>"}}}m+="</div>";if(ep.isPageRTL()){m=ep.utilities.bidiSanitizeContent(m)}return m}function w(g,h,d){if(g.ResultListIndex){return r(g.ResultListIndex,"",h,false)}else{if(g.FooterLinks){var c=g.FooterLinks;if(c&&c.length>0&&g.TargetId){for(var e=0;e<c.length;e++){if(c[e].Args==="Citation"||c[e].Text==="Retrieve Item"){var f=jQuery.extend({},c[e]);f.CssClass="";f.Text=h;return p(g.TargetId,f)}}}return null}else{var i="";if(d){i+='<a href="'+d+"\" data-auto='title_link'>"+h+"<a/>"}else{i=h}return i}}}function q(c){var d=c[0];b.each(c,function(f,e){if(f>0){d+="; "+e}});return d}function n(c,d){if(!c){return false}return _.indexOf(c,d)>-1}function o(f,j){var g="hover-add-folder";var d=ep.clientData.hoverPreviewLabelData.AddToFolder;var e=!j.RecordHasEISExtLink?ep.clientData.hoverPreviewLabelData.AddToFolderTitle:ep.clientData.hoverPreviewLabelData.AddExternalRecToFolder;var h=false;if(j.ResultListIndex){var i=document.getElementById("add_"+j.ResultListIndex);if(i&&i.style.display==="none"){h=true}}else{h=j.IsInFolder}if(h){g="hover-remove-folder";if(ep.dialog.isShowAddFolderPopup){d=ep.clientData.hoverPreviewLabelData.AddRemoveToFolder;e=ep.clientData.hoverPreviewLabelData.AddRemoveToFolderTitle}else{d=ep.clientData.hoverPreviewLabelData.RemoveFromFolder;e=!j.RecordHasEISExtLink?ep.clientData.hoverPreviewLabelData.RemoveFromFolderTitle:ep.clientData.hoverPreviewLabelData.RemoveExternalRecFromFolder}}var c="";if((window.location.href.indexOf("/folder?")<0)&&(!j.NoteContentType)){if(ep.dialog.isShowAddFolderPopup){c+='<a data-auto="hover_folder_link" class="{cssclass}" id="hover_folder" href="#" onclick="ep.dialog.RecordPreview.showFolderPopup(event, {dataIndex})" title="{titleText}"><span data-auto="hover_folder_icon" class="icon"></span>{text}</a>'}else{c+='<a data-auto="hover_folder_link" class="{cssclass}" id="hover_folder" href="#" onclick="return ep.dialog.RecordPreview.toggleHoverFolderLink(this,{dataIndex},{rlindex},{RecordHasEISExtLink});" title="{titleText}"><span data-auto="hover_folder_icon" class="icon"></span>{text}</a>';c=c.replace(/\{rlindex\}/g,j.ResultListIndex?j.ResultListIndex.toString():"null")}c=c.replace(/\{dataIndex\}/,f.toString());c=c.replace(/\{RecordHasEISExtLink\}/,j.RecordHasEISExtLink);c=c.replace(/\{cssclass\}/,g);c=c.replace(/\{text\}/g,d);c=c.replace(/\{titleText\}/g,e)}else{c+='<span data-auto="hover_remove_folder_icon" class="hover-remove-folder"><span class="icon"></span>';c+=ep.clientData.hoverPreviewLabelData.FolderItem;c+="</span>";c=c.replace(/\{text\}/,d);c=c.replace(/\{titleText\}/,e)}return c}function p(e,c){var d="<a data-auto='citation_link' href=\"";if(c.DoPostBack===true){d+="javascript";d+=":__doPostBack('";d+=e;d+="','"+c.Args+"');"}else{if(c.Args.indexOf("url=http")>-1){d+=c.Args;d+='" target="_blank'}else{d+=c.Args+'"'}}if(c.CssClass&&c.CssClass.length>0){d+='" class="'+c.CssClass}d+='">'+c.Text;d+="</a>";return d}function r(f,e,c,d){var g=document.getElementById("Result_"+f);var h;if(g){if(g.getAttributeNode("onclick")===null){h="<a data-auto='citation_link' href=\""+g.getAttribute("data-href")+'" onclick="'+a(g.getAttributeNode("data-onclick").nodeValue,c,f,d)}else{h="<a data-auto='citation_link' href=\""+g.getAttribute("href")+'" onclick="'+a(g.getAttributeNode("onclick").nodeValue,c,f,d)}h+='" class="'+e+'">'+c+"</a>"}return h}function a(e,c,f,d){var g=e;if(d){g="__doLinkPostBack('','target~~fulltext||args~~";g+=f;g+="',''); return false;"}return g}function s(f){var i="";var g=jQuery("#formats"+f);if(g.length){var h=jQuery(g).clone();if(jQuery.trim(h.html())===""){var e=jQuery("#smartlinkft"+f);if(e&&e.length){h.append(e[0].outerHTML)}var c=jQuery("#htmlft"+f);if(c&&c.length){h.append(c[0].outerHTML)}var d=jQuery("#pdfft"+f);if(d&&d.length){h.append(d[0].outerHTML)}var j=jQuery("#epubft"+f);if(j&&j.length){h.append(j[0].outerHTML)}}h.find("[id*='Download']").remove();h.find("[class*='requires-wma']").remove();h.find("[class*='audio-clip']").remove();i+=h.html()}return i}return{initPreviewHovers:function(e,c){ep.dialog.RecordPreview.isShowFolderLink=e;var d=jQuery('[id^="hoverPreview"]').length;for(var f=0;f<d;f++){var g="hoverPreview"+(f+1);var h=document.getElementById(g);if(h){ep.dialog.HoverPopup.addHover(g,f,u,c)}}},addSelfContainedRecordPreview:function(d,c){if(!x[d.id]){ep.dialog.HoverPopup.addHover(d,d,v,c)}x[d.id]=true},showFolderPopup:function(d,c){d.preventDefault();var h=c+1;var g=jQuery("#hoverPreview"+h).data("hoverpreviewjson");if(g){var f=false;var i=h?h:"";var e=jQuery("#add_"+i);if(e.length&&e.css("display")!=="none"){f=true}ep.controller.control.AddToFolderPopup.showAddToFolderPopup(d,{theResultId:i,theIsResultList:true,theIsResultHover:true,theIsToggleIcon:f})}},toggleHoverFolderLink:function(d,c,f,g){var h=c+1;var j=jQuery("#hoverPreview"+h).data("hoverpreviewjson");if(j){var i=d.className==="hover-add-folder";if(f!==null){ep.folder.toggleFolderItem(f,i)}else{if(j){var e=ep.utilities.buildAjaxRequestPath("Folder/SetRouteKeyFolderJson",{Db:j.db,Tag:j.tag,Term:j.term});jQuery.ajax({url:e,async:false,success:function(k){ep.folder.toggleFolderItem(f,i,k)}})}}if(i){d.title=!g?ep.clientData.hoverPreviewLabelData.RemoveFromFolderTitle:ep.clientData.hoverPreviewLabelData.RemoveExternalRecFromFolder;d.innerHTML='<span class="icon" data-auto="hover_folder_icon"></span>'+ep.clientData.hoverPreviewLabelData.RemoveFromFolder;d.className="hover-remove-folder";j.IsInFolder=true}else{d.title=!g?ep.clientData.hoverPreviewLabelData.AddToFolderTitle:ep.clientData.hoverPreviewLabelData.AddExternalRecToFolder;d.innerHTML='<span class="icon" data-auto="hover_folder_icon"></span>'+ep.clientData.hoverPreviewLabelData.AddToFolder;d.className="hover-add-folder";j.IsInFolder=false}}return false}}}()})(jQuery);(function(d){function c(){var m=d("#pubDateRange");if(!m.length){return}ep.debug("ep.dualSlider.init");var p=d("#filterDateFrom > input"),q=d("#filterDateTo > input"),b=d("#common_DT1_FromYear"),a=d("#common_DT1_ToYear"),l=parseInt(p.val(),10)||ep.clientData.dateSliderData.FromYear,r=parseInt(q.val(),10)||ep.clientData.dateSliderData.ToYear;if(!m.length){return}m.slider({range:true,min:l,max:r,values:[l,r]});m.bind("slide",function(f,e){p.val(e.values[0]);b.val(e.values[0]);q.val(e.values[1]);a.val(e.values[1]);d("#resultsLimiterContent").trigger("click")});function o(e){var f=d(e.target);if(f.val()<p.val()){f.val(p.val())}else{if(f.val()>q.val()){f.val(q.val())}}b.val(p.val());a.val(q.val());m.slider("values",[p.val(),q.val()]);m.trigger("change")}function n(g){var f=d(g.target);var e=g.keyCode;if(e===d.ui.keyCode.UP){f.val(parseInt(f.val(),10)+1);o(g)}else{if(e===d.ui.keyCode.DOWN){f.val(parseInt(f.val(),10)-1);o(g)}}}p.blur(o);q.blur(o);p.keydown(n);q.keydown(n)}d(c);ep.dualSlider={init:c}})(jQuery);(function(f){var d;function e(b,a){ep.debug("ep.controller.control.ClusterControl.recordClusterPanelState");var c=ep.utilities.buildAjaxRequestPath("Panel/UpdateCluster");f.ajax({type:"post",url:c,data:{theCluster:b,isExpanded:a}})}f(document).ready(function(){ep.debug("ep.controller.control.ClusterControl.onDomLoaded");ep.getInstance("ep.utilities");d=f("#ClusterContainer");if(d.length){d.find(".cluster-more-link").each(function(b,a){ep.dialog.ToggledPopup.addDialog(a,f(a).parents("ul").next()[0],null,200,"Close",null,true)})}else{d=f("#multiSelectClusterContainer")}if(d.length){d.find(".collapse-toggle").each(function(){f(this).bind("toggled",function(b,a){var c=f(this).children("input");if(!c.length){c=f(this).parent().find("input[name='_clusterId_']").first()}e(c.val(),f(this).hasClass("active"))})})}})})(jQuery);(function(g){var h;var e;function f(a){var b=ep.utilities.buildAjaxRequestPath("Panel/UpdateDocType");g.ajax({type:"post",url:b,data:{theIsExpanded:a}})}g(document).ready(function(){ep.getInstance("ep.utilities");h=g.extend(g("#DocTypeContainer"),g("#multiSelectDocType"));if(g("#DocTypeContainer").length===0&&g("#multiSelectDocType").length===0){return}e=g("#moreDocumentTypesLink")[0];if(e){var a=function(c){return c.innerHTML.replace("none","block")};var b=g("#doc-type-overflow")[0];ep.dialog.ToggledPopup.addDialog(e,b,a,250,"a")}h.find(".panel_toggle, .panel_toggle_active, .collapse-toggle").each(function(d,c){g(c).bind("CollapsiblePanel_toggled",function(l,k){f(k.isExpanded)});g(c).bind("toggled",function(l,k){f(g(this).hasClass("active"))})})})})(jQuery);ep.register("ep.controller.control.ImageQuickView",function(k){var h=function(a){ep.debug("ep.controller.control.ImageQuickView.onIQVLinkClick");a.preventDefault();var b=k(a.target).data("iqvargs");if(b){m(ep.controller.control.ImageQuickView.thumbnailType,b)}};function l(a){ep.debug("ep.controller.control.ImageQuickView.setEvents");var b=k("a[id^='linkQuikView']");if(b.length){if(a){b.unbind()}else{b.click(h)}}}function j(c,b){ep.debug("ep.controller.control.ImageQuickView.setAjaxActivity");var a=k("#ajaxActivity_"+b);if(a.length){a.css({display:(c)?"inline":"none"})}}function m(b,c){ep.debug("ep.controller.control.ImageQuickView.getThumbnails");var a=c.itemId;var e=("tContainer2_"+a);j(true,a);if(k("#"+e).is(":empty")){var d={theThumbnailType:b,SearchTerm:c.searchTerm,DB:c.db,ParentUI:c.an,Tag:c.tag,theSearchData:c.searchData};var f=ep.utilities.buildAjaxRequestPath("ImageQuickView/GetThumbnails");k.ajax({type:"POST",url:f,data:d,context:this,success:function(g){n(e,g)}})}else{n(e)}}function n(b,a){ep.debug("ep.controller.control.ImageQuickView.processThumbnailData");var e=k("#"+b);var c=b.split("_")[1];var f=k("#linkQuikView11_"+c);var d=k("#linkQuikView21_"+c);var g=k("#linkQuikView22_"+c);if(e.is(":visible")){e.hide();f.css({display:"inline"});d.css({display:"none"});g.parent().css({display:"none"})}else{e.show();f.css({display:"none"});d.css({display:"inline"});g.parent().css({display:"inline"})}if(e.is(":empty")){e.html(a)}j(false,c)}function i(){ep.debug("ep.controller.control.ImageQuickView.Initialize");ep.getInstance("ep.utilities");l(false);k(window).unload(k.proxy(function(){l(true)},this))}ep.domLoad(i)}(jQuery));var aNamespace=ep.register("ep.controller.control.RelatedInfoControl");ep.controller.control.RelatedInfoControl.resolvePendingExternalItems=function(){ep.debug("ep.controller.control.RelatedInfoControl.resolvePendingExternalItems");var p;var j=ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject();if(j&&j.has_external_items()){var l=j.get_external_items();for(p=0;p<l.length;p++){var o=l[p].get_element().find(".panel_toggle").first();jQuery(o).on("click",ep.controller.control.RelatedInfoControl.onPanelExpand)}}if(j&&j.has_pending_items()){var m=[];var k=j.get_pending_items();for(p=0;p<k.length;p++){m.push(k[p].get_itemID())}var n=ep.utilities.replaceEPCommand("resolvependingsearchtabs");var i=jQuery.ajax({url:n,type:"POST",data:{TabIDs:m}}).done(function(a){ep.controller.control.RelatedInfoControl.onPendingExternalItemsResolved(a,k)})}};ep.controller.control.RelatedInfoControl.onPendingExternalItemsResolved=function(h,k){ep.debug("ep.controller.control.RelatedInfoControl.onPendingExternalItemsResolved");if(h===null){return}var j=h.split(",");if(j&&j.length>0){for(var i=0;i<j.length;i++){var l=parseInt(j[i],10);if(l===1){k[i].set_itemState("Normal")}else{if(l===0){k[i].set_itemState("Disabled")}}}var g=ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject();if(g.has_pending_items()){window.setTimeout(ep.controller.control.RelatedInfoControl.resolvePendingExternalItems,0)}}};ep.controller.control.RelatedInfoControl.showExternalSourcePreview=function(c){ep.debug("ep.controller.control.RelatedInfoControl.showExternalSourcePreview");var d=document.getElementById(c);return d?d.innerHTML:null};ep.controller.control.RelatedInfoControl.onPanelExpand=function(j){ep.debug("ep.controller.control.RelatedInfoControl.onPanelExpand");var i=jQuery(j.target).closest('div[id$="externalItem"]');var l=i.find("h3.panel_toggle").first();jQuery(l).off("click",ep.controller.control.RelatedInfoControl.onPanelExpand);var g=jQuery("#__sid").val();var h=jQuery("#__vid").val();var k=i.find('input[name="externalitemid"]').first().val();ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearch(k,i)};ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject=function(){ep.debug("ep.controller.control.RelatedInfoControl._getEPRelateInfoExternalBehaviorObject");var b=jQuery("#relatedInfoControl");if(b.length&&b.children().get(0)){return new EPRelatedInfoExternalBehavior(b.children().get(0))}return null};ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearch=function(f,g){ep.debug("ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearch");var h=ep.utilities.replaceEPCommand("performrelatedinfoexternalsearch");var e=jQuery.ajax({url:h,type:"POST",data:{GroupName:f},dataType:"xml"}).done(function(a){ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearchComplete(a,g)})};ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearchComplete=function(z,i){ep.debug("ep.controller.control.RelatedInfoControl.performRelatedInfoExternalSearchComplete");var r=z;if(r===null){return}var v=ep.utilities.selectSingleNode(r,"EPResponse/ControlHtml");var q=ep.utilities.getXmlElementValue(v);if(q===null){q=""}var s=ep.utilities.selectSingleNode(r,"EPResponse/ShowFindMoreLink");var p=ep.utilities.getXmlElementValue(s);if(p===null){p="false"}var u;if(i){var B=jQuery(i).find(".external-source-content");if(B.length){u=jQuery(B).get(0)}}if(u){u.innerHTML=q;var t=getElementByClientId("lnkFindMore",i);if(t){t.className=p==="true"?"find-more":"find-more-hidden"}var A=jQuery(u).find(".preview-hover");for(var x=0;x<A.length;x++){var y=A.get(x);var w=y.id+"-content";ep.dialog.HoverPopup.addHover(y.id,w,ep.controller.control.RelatedInfoControl.showExternalSourcePreview,570)}}};ep.domLoad(ep.controller.control.RelatedInfoControl.resolvePendingExternalItems);ep.registerInstance("ep.controller.control.LimitYourResultsControl","ep.base.Controller",{IS_CHANGED:0,onDomLoad:function(){ep.debug("ep.controller.control.LimitYourResultsControl.onLoad");var m=jQuery("#resultsLimiterContent");if(m.length){jQuery("#pubDateRange").live("slidechange",jQuery.proxy(this.onSliderChanged,this));var l=m.find('input[type="checkbox"]');l.click(jQuery.proxy(this.enableUpdateResultsButton,this));var n=m.find('input[id$="HasSliderBeenSet"]').val();if(n==="1"){var h=ep.clientData.dateSliderData;if(h){this.setPubDateLimiterFields(h.FromYear,h.ToYear)}}}ep.getInstance("ep.utilities");var i=jQuery("#resultsLimiterControl");var k=this;if(i.length){var j=i.find(".collapse-toggle");jQuery(j).bind("toggled",function(b,a){k.recordResultLimiterPanelState(jQuery(i).hasClass("active"))})}},enableUpdateResultsButton:function(j){ep.debug("ep.controller.control.LimitYourResultsControl.enableUpdateResultsButton");var g=jQuery("#resultsLimiterContent");var i=g.find('input[id$="isSliderChanged"]');var l=g.find('input[id$="UpdateButton"]').first();var k=j.target;var h=jQuery(k);if(l.is(":disabled")&&(i.val()==="1"||(k.tagName==="INPUT"&&h.attr("type")==="checkbox"))){l.removeClass("buttonDisabled");l.prop("disabled",false);this.IS_CHANGED=1}},onSliderChanged:function(l,j){ep.debug("ep.controller.control.LimitYourResultsControl.onSliderChanged");var p=jQuery("#resultsLimiterContent");var m=parseInt(p.find('input[id$="MinDateOrig"]').val(),10);var o=parseInt(p.find('input[id$="MaxDateOrig"]').val(),10);var k=p.find('input[id$="isSliderChanged"]');var n=parseInt(jQuery("#common_DT1_FromYear").val());var i=parseInt(jQuery("#common_DT1_ToYear").val());if(n<j.values[0]){j.values[0]=n}if(i>j.values[1]){j.values[1]=i}if(j.values[0]!==m||j.values[1]!==o){k.val("1");p.trigger("ep_DualSlider_sliderChanged",j);this.enableUpdateResultsButton(l)}else{k.val("0")}this.setPubDateLimiterFields(jQuery("#common_DT1_FromYear").val(),jQuery("#common_DT1_ToYear").val())},setPubDateLimiterFields:function(d,c){ep.debug("ep.controller.control.LimitYourResultsControl.setPubDateLimiterFields");jQuery("#common_DT1_FromYear").val(d);jQuery("#common_DT1_ToYear").val(c)},recordResultLimiterPanelState:function(c){ep.debug("ep.controller.control.LimitYourResultsControl.recordResultLimiterPanelState");var d=ep.utilities.buildAjaxRequestPath("Panel/UpdateResultLimiter");jQuery.ajax({type:"post",url:d,data:{theIsExpanded:c}})}});var aNamespace=ep.register("ep.controller.control.FolderItemsControl");ep.controller.control.FolderItemsControl.updateFolderCount=function(c){ep.debug("ep/controller/control/folderitemscontrol.js -> updateFolderCount");var d=window.isToolbarOnParent&&window.parent?window.parent:window;d.ep.folder.updateToolbarFolderCount(c)};ep.controller.control.FolderItemsControl.folderItemsAddRemove=function(l,j,n,i,m,h){ep.debug("ep/controller/control/folderitemscontrol.js -> folderItemsAddRemove");var k={DbName:l,UITag:j,UITerm:n,Title:i};EPWebServices.FolderWebService.FolderItemsAddRemove(ep.controller.control.FolderItemsControl._getSessionParams(),k,m,h,ep.controller.control.FolderItemsControl.onSuccessfulAddRemove);ep.controller.control.FolderItemsControl.folderItemsToggleResultList(k,m);ep.controller.control.FolderItemsControl.updateFolderCount(m);return false};ep.controller.control.FolderItemsControl.folderItemsToggleResultList=function(j,n){ep.debug("ep/controller/control/folderitemscontrol.js -> folderItemsToggleResultList");var p=1;var o=$("#add_"+p);while(o.length&&p<101){o=$("#add_"+p).data("folder");if(typeof o==="object"){o=JSON.stringify(o)}var k=ep.folder.escapeAndParseJson(o);var l=k.db;var m=k.uiTag;var q=k.uiTerm;if(j.DbName===l&&j.UITag===m&&j.UITerm.toString()===q&&j.Title){var r="";if(jQuery("#added_"+p).length){if(n){jQuery("#added_"+p).css("display",r);$("add_"+p).hide()}else{$("added_"+p).hide();jQuery("#add_"+p).css("display",r)}}else{ep.controller.control.FolderItemsControl.setCitationFolder(n)}break}p++}return false};ep.controller.control.FolderItemsControl.setCitationFolder=function(i){ep.debug("ep/controller/control/folderitemscontrol.js -> setCitationFolder");var h=jQuery("#AddToFolderClientIDs").val().split(",");var j=0;var g=7;var f="";if(i){do{if(j%2){f="none"}else{f="inline"}if("#"+jQuery(h[j]).length){jQuery("#"+h[j]).css("display",f)}j=j+1}while(j<g)}else{do{if(j%2){f="inline"}else{f="none"}if(document.getElementById(h[j])){document.getElementById(h[j]).style.display=f}j=j+1}while(j<g)}};ep.controller.control.FolderItemsControl.onSuccessfulAddRemove=function(d){ep.debug("ep/controller/control/folderitemscontrol.js -> onSuccessfulAddRemove");var c=jQuery("#folderItemsContainerControl");if(c.length){c.html(d)}};ep.controller.control.FolderItemsControl._getSessionParams=function(){ep.debug("ep/controller/control/folderitemscontrol.js -> _getSessionParams");return{sessionID:jQuery("#__sid").val(),sessionVId:jQuery("#__vid").val()}};ep.registerClass("ep.base.ResultListController",{initialize:function($super,b){$super(b)},_domLoaded:function($super){this.initializeControls();$super()},_windowLoaded:function($super){_.defer(ep.loadImages);$super()},initializeControls:function(){if(jQuery("#ClusterContainer").length){ep.require("ep/controller/control/ClusterControl.js")}if(jQuery("a[data-audiosummarydb]").length){ep.require("ep/controller/control/audiosummary.js")}var b=jQuery("a[id^='linkQuikView']");if(b.length){ep.getInstance({epId:"ep.controller.control.ImageQuickView",thumbnailType:"THUMB_SMALL"})}}},"ep.base.PageController");(function(b){b.widget("ui.simpleaccordion",{options:{tabOpenCallbacks:{},tabCloseCallbacks:{},tabOtherCloseCallbacks:{}},_create:function(){var a=this;_.bindAll.apply(_,[this].concat(_.functions(this)));this.tabs=[];this.$tabs=this.element.find("[data-simple-accordion-tab]");this.$contents=this.element.find("[data-simple-accordion-content]");b(this.$tabs).each(_.bind(function(i,h){var j=b(h),g={isActive:false,$tab:j,$content:this.getContentElement(j),hasBeenActivated:false};this.tabs.push(g);j.click(_.bind(function(c){g.isActive=!g.isActive;g.$tab.toggleClass("active");g.$content.toggle();if(g.isActive){a.executeCallbacks("tabOpenCallbacks",g)}else{a.executeCallbacks("tabCloseCallbacks",g)}b.each(this.tabs,function(e,d){if(g!==this&&this.isActive){a.executeCallbacks("tabCloseCallbacks",d);a.executeCallbacks("tabOtherCloseCallbacks",d);this.isActive=false;this.$tab.removeClass("active");this.$content.hide()}});g.hasBeenActivated=true},this))},this))},getContentElement:function(a){return this.$contents.filter('[data-simple-accordion-content="'+a.data("simpleAccordionTab")+'"]')},executeCallbacks:function(d,a){b.each(this.options[d],_.bind(function(f,c){if(a.$tab.data("simpleAccordionTab")===parseInt(f,10)){c(a,this.element)}},this))}})})(jQuery);(function(b){ep.require("_layout2/alertmodaldialog.css",function(){b(function(){var n,j,k,m,l,a;b(document).on("click",'input[id$="submitAlert"]',function(c){i();return false});b(document).on("click",'input[id$="cancelAlert"]',function(c){b(".ui-dialog-titlebar-close").trigger("click");return false});b(document).on("keypress","#email",function(c){if(c.which===13){i();return false}});b(document).on("keypress",'input[id$="submitAlert"]',function(c){if(c.which===13){i();return false}});function i(){var d=b("#alertContent").validate({rules:{email:{required:true,email:true}},messages:{email:{required:ep.messages.verify_email,email:ep.messages.verify_email}},onsubmit:false});if(!d.form()){return false}k=b("#alertVerificationMessage");m=b("#alertFrequency");l=b("#serverError");a=b("#email");n=b('input[id$="cancelAlert"]');b(".epmodal.ui-dialog").css("width","800px");if(l.attr("class")==="error"){l.removeClass();l.addClass("hidden")}var c=jQuery("#alertWrapper").data("alertdata");j=ep.utilities.buildAjaxRequestPath("Alert/SendAlertEmail")+"&theAlertName="+c.theAlertName+"&theAlertType="+c.theAlertType+"&theAlertSearchString="+c.theAlertSearchString+"&theEmailAddress=";b.ajax({url:j+a.val()+"&theAlertFrequency="+m.val(),success:function(e){if(e.IsError){l.removeClass();l.addClass("error");l.html(e.Message)}else{var f=b(e).find(".email-alert");b("#headerPersonalized").remove();f.find("h2").remove();f.find("button").remove();b(".alert-list-wrapper").first().html(f);b("#submitAlert").hide();n.val(ep.messages.ok);n.addClass("primary-action")}}})}})})})(jQuery);jQuery.fn.absolutize=function(){return this.each(function(){var g=jQuery(this);if(g.css("position")==="absolute"){return g}var k=g.offset();var i=k.top;var j=k.left;var l=g[0].clientWidth;var h=g[0].clientHeight;g._originalLeft=j-parseFloat(g.css("left")||0);g._originalTop=i-parseFloat(g.css("top")||0);g._originalWidth=g.css("width");g._originalHeight=g.css("height");g.css("position","absolute");g.css("top",i+"px");g.css("left",j+"px");g.css("width",l+"px");g.css("height",h+"px");return g})};(function(b){ep.registerClass("ep.base.ModalDialogController",{command:null,$coverScreen:null,previousAspForm:null,display:null,content:null,$loadDialog:null,showCloseButton:true,showModalDuration:0.5,showCoverDuration:0.5,dialogClass:null,initialize:function($super,a){$super(a)},show:function(){if(!this.previousAspForm&&window.theForm){this.previousAspForm=window.theForm}this.displayLoadDialog();if(!this.$coverScreen){this.$coverScreen=b("#modal-screen")}if(!this.$coverScreen.is(":visible")){this._layoutScreen();this.$coverScreen.fadeTo(this.showCoverDuration,this.screenOpacity||0.5)}},_domloaded:function(){this.onLoad()},initDisplay:function(){var j;var n,p;var k=this.dialogClass?"modal-dialog "+this.dialogClass:"modal-dialog ";if(this.showCloseButton){j=b("<div waiRole='dialog' class='"+k+"'><span tabIndex=0 class='ui-icon ui-icon-closethick'>Close</span></div>").get(0)}else{j=b("<div waiRole='dialog' class='"+k+"'>").get(0)}n=document.body.appendChild(j);if(this.cssClass){b(n).addClass(this.cssClass)}b(n).css({display:"none"});var o=b.proxy(function(c){this.handleCloseKeyPress(c)},this);p=b(".modal-dialog .ui-icon-closethick");if(this.showCloseButton){p.on("click",b.proxy(this.hide,this))}p.on("keydown",o);var m=b("<div>").get(0);m.id="modal-content";m.className=this.containerId="modal-content";if(this.content){b(m).append(this.content)}b(n).append(m);var a=b("<span tabIndex=0 class='modal-tab-end'>").html(" ");b(n).append(a);var l=b.proxy(function(){this.display.container.firstChild.focus()},this);a.on("focus",l);this.display={container:n,closeElement:this.showCloseButton?p.get(0):null,contentElement:m};this.container=this.display.contentElement},displayLoadDialog:function(a){if(!a){a="Loading ..."}if(!this.$loadDialog){this.$loadDialog=b("<div tabIndex=0 class='modal-loading'>");this.$loadDialog.css({position:"absolute"})}this.$loadDialog.html(a);b(document.body).append(this.$loadDialog);this.$loadDialog.css({top:"-1000px",left:"0px"});var d=b.proxy(function(){try{this.$loadDialog.focus()}catch(c){}},this);d();this.$loadDialog.effect("pulsate",{times:30},"normal")},_layoutScreen:function(){if(!this.$coverScreen){this.$coverScreen=b("#modal-screen")}if(!this.$coverScreen.length){this.$coverScreen=b("<div id='modal-screen' class='modal-screen'>");this.$coverScreen.hide()}this.$coverScreen.insertBefore(this.display.container);var f={width:b(window).width(),height:b(window).height()};var g={height:document.documentElement.scrollHeight,width:document.documentElement.scrollWidth};g.height=g.height>f.height?g.height:f.height;g.width=g.width>f.width?g.width:f.width;var a={left:b(window).scrollLeft(),top:b(window).scrollTop()};this.$coverScreen.css({top:"0",left:"0px",height:g.height+"px",width:g.width+"px"});if(this.$loadDialog){var h={width:this.$loadDialog.outerWidth(),height:this.$loadDialog.outerHeight()};this.$loadDialog.css({top:(a.top+f.height/2-h.height/2)+"px",left:(a.left+f.width/2-h.width/2)+"px"})}},handleCloseKeyPress:function(a){if(a.keyCode===13){this.hide()}else{if(a.keyCode===9&&a.shiftKey){a.preventDefault()}}},hide:function(){if(this.display){var a=b.proxy(function(){if(this.childForms&&this.childForms.length){b.each(this.childForms,function(e,f){f.reset()})}},this);b(this.display.container).fadeOut("normal",a);if(_.isFunction(this.onHide)){this.onHide()}this.$coverScreen.dialog=this;this._hideCoverScreen();window.theForm=this.previousAspForm||null}},_hideCoverScreen:function(){this.$coverScreen.fadeOut("normal",this._onAfterHide)},_onAfterHide:function(){b(".modal-dialog, .modal-loading, .modal-screen").each(function(a,d){b(d).remove()});this.display=this.$coverScreen=this.content=null},_onunloaded:function($super){$super();b(".modal-dialog, .modal-loading, .modal-screen").each(function(a,d){b(d).remove()});this.display=this.$coverScreen=this.content=null},render:function(){this.layout();b(this.display.container).fadeIn(this.showModalDuration,this.renderComplete.bind(this));this.childForms=b(this.display.contentElement).find("form");if(window.theForm&&this.childForms.length>0){window.theForm=this.childForms[0]}this.childForms.each(b.proxy(function(a,d){d.dialog=this;if(_.isFunction(this.onsubmit)){b(d).on("submit",this.onsubmit)}},this))},layout:function(){this.$loadDialog.stop(true,true).fadeOut("normal");if(this.display){b(this.display.container).css({position:"absolute",top:"-10000px",left:"0px",display:"block"});var h={width:b(this.display.container).outerWidth(),height:b(this.display.container).outerHeight()};var g={width:b(window).outerWidth(),height:b(window).outerHeight()};var a={left:b(window).scrollLeft(),top:b(window).scrollTop()};b(this.display.container).hide();var f=a.top+10;if(h.height<g.height){f=a.top+g.height/2-h.height/2}b(this.display.container).css({top:f+"px",left:(a.left+(g.width||document.body.clientWidth)/2-h.width/2)+"px"});if(this.showCloseButton){b(this.display.closeElement).absolutize()}}},renderComplete:function(){this.focusTitle();if(this.$loadDialog){this.$loadDialog.fadeOut("fast")}if(_.isFunction(this.onModalRender)){this.onModalRender()}},focusTitle:function(){if(_.isString(this.titleElement)){var a=b(this.display.contentElement).find(this.titleElement).get(0);if(a){a.tabIndex=0;a.focus()}}},onUpdate:function(){this.render()}},"ep.base.ModuleController")})(jQuery);ep.registerClass("ep.base.ModalPanelController",{showCloseButton:true,panelElement:null,panel:null,panelProps:null,parentProps:null,showModalDuration:0,dialogClass:"modal-panel",modalPanel:null,checkboxes:[],defaultValues:{},isSubmit:null,isValidate:true,command:null,coverScreen:{},previousAspForm:null,display:null,content:null,showCoverDuration:500,screenOpacity:0.5,clickedEl:null,onDomLoad:function(){this.panel=jQuery("#"+this.panelElement);this.setPanelEvents();this.storeState()},storeState:function(){this.checkboxes=this.panel.find('input[type="checkbox"]').attr("autocomplete","off");this.defaultValues={};this.checkboxes.each(jQuery.proxy(function(d,c){this.defaultValues[c.id]={checked:c.checked,disabled:c.disabled}},this))},revertState:function(){this.checkboxes.each(jQuery.proxy(function(e,f){var d=this.defaultValues[f.id];f.checked=d.checked;f.disabled=d.disabled},this))},setPanelEvents:function(){if(this.panel.length){this.panel.bind("click.modalpanel",jQuery.proxy(this.columnPanelClickHandler,this))}},setPanelPosition:function(){if(!this.panelProps){this.initPanelProps()}var b=this.panel.offset();this.panelProps.left=b.left;this.panelProps.top=b.top;if(this.parentProps){this.panelProps.left-=this.parentProps.paddingLeft}},initPanelProps:function(){this.panelProps={top:null,left:null,width:this.panel.width(),cols:1,colWidth:this.panel.width()};var b=this.panel.parents("#column1, #column2").first();if(b.length){this.parentProps={paddingLeft:parseFloat(b.css("padding-left")),paddingRight:parseFloat(b.css("padding-right"))};this.panelProps.width=this.panelProps.colWidth+=(this.parentProps.paddingLeft+this.parentProps.paddingRight+40)}},setPanelSize:function(){this.panelProps.width=this.panelProps.colWidth*this.panelProps.cols},createPlaceholder:function(){this.placeholder=jQuery("<div>");this.placeholder.css("height",this.panel.height()+"px");this.panel.before(this.placeholder)},restorePanel:function(){if(this.placeholder&&this.placeholder.length){if(this.panel.parent().length){this.panel.remove()}this.placeholder.after(this.panel);this.placeholder.remove();this.panel.unbind(".modalpanel");this.setPanelEvents();this.placeholder=null}},movePanel:function(){this.setPanelPosition();this.setPanelSize();this.createPlaceholder();this.panel.unbind(".modalpanel");this.content=this.panel;this.showModal()},showModal:function(){window.setTimeout(_.bind(function(){function b(i){var g=jQuery(window).scrollTop();var h=g+jQuery(window).height();var a=jQuery(i).offset().top;var j=a+jQuery(i).height();return((j<=h)&&(a>=g))}this.initDisplay();this.render();this.show();if(this.clickedEl){if(!b(this.clickedEl)){this.clickedEl.scrollIntoView()}}},this),0)},render:function(){this.modalPanel=jQuery("#modal-content");this.toggleFormControls(true);this.layout();this.modalPanel.find(".collapse-toggle").data("disableexpandcollapse","true");this.display.container.fadeIn(this.showModalDuration,jQuery.proxy(this.renderComplete,this));this.childForms=this.display.contentElement.find("form");if(window.theForm&&this.childForms.length>0){theForm=this.childForms.get(0)}this.childForms.each(jQuery.proxy(function(d,c){if(jQuery.isFunction(this.onSubmit)){jQuery(c).bind("submit.modalpanel",this.onSubmit)}},this))},onModalRender:function(){this.setModalEvents()},setModalEvents:function(){if(this.modalPanel.length){this.modalPanel.unbind(".modalpanel");this.modalPanel.bind("click.modalpanel",jQuery.proxy(this.modalPanelClickHandler,this))}},hide:function(){if(this.display){this.display.container.fadeOut(this.showModalDuration,jQuery.proxy(this._resetFormElements,this));this._hideCoverScreen();theForm=this.previousAspForm||null}this.modalPanel=null;this.toggleFormControls(false);this.restorePanel();if(this.isSubmit!==true){this.revertState()}},_resetFormElements:function(){if(this.childForms&&this.childForms.length){this.childForms.each(function(c,d){d.reset();d=null})}},_hideCoverScreen:function(){if(this.isSubmit!==true){this.coverScreen.fadeOut(this.showCoverDuration,this._onAfterHide)}},layout:function(){if(this.display){if(this.panelProps.top){this.display.container.css({top:this.panelProps.top+"px"})}if(this.panelProps.left){this.display.container.css({left:this.panelProps.left+"px"})}if(this.panelProps.width){this.display.container.css({width:this.panelProps.width+"px"})}if(this.panelProps.height){this.display.container.css({height:this.panelProps.height+"px"})}}},onUpdate:function(){this.setPanelSize();this.render()},columnPanelClickHandler:function(c){var d=jQuery(c.target);if(d.is("input")&&!d.is("[type='submit']")&&!d.is("[type='button']")){this.clickedEl=d.get(0);this.movePanel()}},modalPanelClickHandler:function(c){ep.debug("modalpanelcontroller : modalPanelClickHandler()");var d=jQuery(c.target);this.isSubmit=false;if(d.is("input[type='submit'], input[type='button']")){if(this.isValidate){this.isSubmit=true;this.hide()}}if(d.is("a.panelCancel")){this.hide()}},toggleFormControls:function(b){ep.debug("modalpanelcontroller : toggleFormControls()");if(b){this.modalPanel.find("input[type='submit'], input[type='button']").each(jQuery.proxy(function(d,a){a.disabled=null;this.insertCancel(a)},this))}else{if(this.isSubmit!==true){this.panel.find("input[type='submit'], input[type='button']").attr("disabled","disabled").trigger("enabledStateChange",[true])}this.panel.find(".modalOnly, .panelCancel").remove()}},insertCancel:function(c){ep.debug("modalpanelcontroller : insertCancel()");var d=jQuery("<a data-auto='cancel_link'>").addClass("panelCancel").text(ep.messages.cancel);jQuery(c).after(d)},show:function(){if(!this.previousAspForm&&window.theForm){this.previousAspForm=theForm}this._layoutScreen();this.coverScreen.fadeTo(this.showCoverDuration,this.screenOpacity)},initDisplay:function(){var g,e=jQuery("<div>").attr("waiRole","dialog").addClass("modal-dialog").hide();jQuery("body").append(e);if(this.dialogClass){e.addClass(this.dialogClass)}if(this.showCloseButton){g=jQuery("<span>").prop("tabindex",0).addClass("ui-icon ui-icon-closethick");g.html("</span><span>Close</span>");g.bind("click.modalpanel",jQuery.proxy(this.hide,this));g.bind("keydown.modalpanel",jQuery.proxy(this.handleCloseKeyPress,this));e.append(g)}this.containerId="modal-content";var h=jQuery("<div>").attr("id",this.containerId).addClass(this.containerId);if(this.content&&this.content.length){h.append(this.content)}e.append(h);var f=jQuery("<span>").prop("tabindex",0).addClass("modal-tab-end").text(" ");e.append(f);f.bind("focus.modalpanel",jQuery.proxy(this.tabEndHandler,this));this.display={container:e,closeElement:this.showCloseButton?g:null,contentElement:h};this.container=this.display.contentElement},_layoutScreen:function(){if(!this.coverScreen){this.coverScreen=jQuery("#modal-screen")}if(!this.coverScreen.length){this.coverScreen=jQuery("<div>").attr("id","modal-screen").addClass("modal-screen").css("z-index",9000).hide()}this.display.container.before(this.coverScreen);var c={height:jQuery(window).height(),width:jQuery(window).width()};var d={height:jQuery(document).height(),width:jQuery(document).width()};d.height=d.height>c.height?d.height:c.height;d.width=d.width>c.width?d.width:c.width;this.coverScreen.css({top:"0",left:"0px",height:d.height+"px",width:d.width+"px"})},handleCloseKeyPress:function(b){if(b.which===jQuery.ui.keyCode.ENTER){this.hide()}else{if(b.which===jQuery.ui.keyCode.ENTER&&b.shiftKey){b.preventDefault()}}},tabEndHandler:function(){this.display.container.find(":tabbable").first().focus()},_onAfterHide:function(){if(this.trigger){this.trigger.focus()}jQuery(".modal-dialog, .modal-loading, .modal-screen").remove();this.display=this.content=null},renderComplete:function(){if(_.isFunction(this.onModalRender)){this.onModalRender()}}},"ep.base.ModuleController");(function(b){ep.require("spinner/spin.min.js",function(){ep.registerClass("ep.base.SelectMultipleController",{panelElement:null,panel:null,command:null,coverScreen:null,modalPanel:null,modalCheckboxes:null,modalCbAll:null,modalCbHidden:null,checkboxName:"",modalWindowHeight:null,onDomLoad:function(){this.panel=jQuery("#"+this.panelElement);this.bindEvents()},initialize:function($super,a){$super(a)},bindEvents:function(){this.panel.find(".limControl, .limCaption>a").click(b.proxy(this.selectLimiters,this));this.panel.find("a.evt-select-mulitple").click(b.proxy(this.showModal,this));this.checkboxes=this.panel.find('input[type="checkbox"]').attr("autocomplete","off");this.checkboxName=this.checkboxes.first().attr("name")},selectLimiters:function(a){var i=b(a.currentTarget);this.showLoading();if(i.is("input.limControl")){var j=i.data("url");var h=(i.is(":checked"))?j.checked:j.unchecked;window.location=h}else{var g=i.parents("li").find(".limControl");g.prop("checked",true);a.preventDefault();a.stopPropagation();window.location=i.attr("href")}},showLoading:function(){this._layoutScreen();this.coverScreen.fadeTo(200,0.5);this.loadingMessage.show()},_layoutScreen:function(){if(!this.coverScreen){this.coverScreen=b("#modal-screen")}if(!this.coverScreen.length){this.coverScreen=b("<div>").attr("id","modal-screen").addClass("ui-widget-overlay").css("z-index",9000).hide()}b("body").append(this.coverScreen);var h={height:jQuery(window).height(),width:jQuery(window).width()};var j={height:jQuery(document).height(),width:jQuery(document).width()};j.height=j.height>h.height?j.height:h.height;j.width=j.width>h.width?j.width:h.width;this.coverScreen.css({top:"0",left:"0px",height:j.height+"px",width:j.width+"px"});if(!this.loadingMessage){this.loadingMessage=b("#modal-loading")}if(!this.loadingMessage.length){this.loadingMessage=b("<div>").attr({id:"modal-loading",tabIndex:"0","data-auto":"spinner"}).hide();var a=b("<div>").addClass("container").append("<span>Updating...</span>");var i={lines:9,length:4,width:2,radius:2,corners:1,rotate:13,direction:1,color:"#000",speed:0.8,trail:65,shadow:false,hwaccel:false,className:"spinner",zIndex:2000000000,top:"0px",left:"auto"};var g=new Spinner(i).spin(a.get(0));this.loadingMessage.append(a)}b("body").append(this.loadingMessage);this.loadingMessage.addClass("modal-loading").css({position:"fixed",top:((h.height/2)-(this.loadingMessage.outerHeight()/2))+"px",left:((h.width/2)-(this.loadingMessage.outerWidth()/2))+"px"})},showModal:function(a){a.preventDefault();a.stopPropagation();var d=b(a.target);d.epmodal({dataUrl:ep.utilities.replaceEPCommand(this.command+"/ExpandedPanel"),sourceElement:d,dialogClass:"fixed",data:{panelId:this.panelElement},onload:b.proxy(this.onModalLoad,this)})},onModalLoad:function(f){var e=b.proxy(function(c){this.modalPanel.find(c).addClass("disabled")},this);var a=b.proxy(function(c){this.modalPanel.find(c).removeClass("disabled")},this);this.modalPanel=b((f)?f.options.container:"#modal");this.storeModalState();this.modalPanel.find(".evt-update-btn").removeAttr("onclick").on("click",b.proxy(this.formSubmit,this));this.modalPanel.find(".evt-cancel-btn").removeAttr("onclick").bind("click",b.proxy(this.hideModal,this));this.modalPanel.find('input[type="checkbox"]').on("click",b.proxy(this.checkboxHandler,this));this.modalPanel.find("a.panelSortHits").on("click",b.proxy(this.sortByHits,this));this.modalPanel.find("a.panelSortName").on("click",b.proxy(this.sortByName,this));this.modalPanel.find(".limCaption>a").on("click",b.proxy(this.selectModalLimiter,this));if(b(".tbody").height()>b(".modal-content").height()){this.modalPanel.find(".evt-up-btn").removeAttr("onclick").show().on("click",b.proxy(this.scrollUp,this));this.modalPanel.find(".evt-down-btn").removeAttr("onclick").show().on("click",b.proxy(this.scrollDown,this));this.modalWindowHeight=Math.round(7*b(".modal-content").height()/8);ep.require("jquery/plugins/jquery.ba-throttle-debounce.js",b.proxy(function(){b(".modal-content").scroll(b.debounce(150,function(){if(!b(".modal-content").scrollTop()){e(".evt-up-btn");a(".evt-down-btn")}else{a(".evt-up-btn")}if((b(".modal-content").scrollTop()+b(".modal-content").height())>=b(".tbody").height()){e(".evt-down-btn");a(".evt-up-btn")}else{a(".evt-down-btn")}}))},this))}this.modalPanel.find(".modal-content.evt-sort").focus()},selectModalLimiter:function(a){var d=b(a.currentTarget);if(d.is("a")&&d.attr("href")){this.hideModal();this.showLoading();a.preventDefault();a.stopPropagation();window.location=d.attr("href")}},storeModalState:function(){var a=this.checkboxName;this.modalToggleAll=this.modalPanel.find("input.panelToggleAll");this.modalCbAll=this.modalPanel.find('input.panelAllItem[name="'+a+'"]');this.modalCbHidden=this.modalPanel.find('input[type="hidden"][name="'+a+'"]');if(this.modalCbAll.length&&!this.modalCbHidden.length){this.modalCbHidden=jQuery("<input>").attr({type:"hidden",name:a}).val(this.modalCbAll.prop("checked")?this.modalCbAll.val():"");this.modalCbAll.before(this.modalCbHidden)}this.modalCheckboxes=this.modalPanel.find('input[type="checkbox"][name="'+a+'"]')},formSubmit:function(){var a=jQuery("#modalPanelForm").get(0);if(a){a.action=ep.utilities.replaceEPCommand(this.command+"/Update");a.method="post";a.submit()}},hideModal:function(a){this.modalPanel.dialog("close")},scrollUp:function(a){this.smoothScrollModalContent(b(".modal-content").scrollTop()-this.modalWindowHeight)},scrollDown:function(a){this.smoothScrollModalContent(b(".modal-content").scrollTop()+this.modalWindowHeight)},smoothScrollModalContent:function(l){var h=l-b(".modal-content").scrollTop();var j=(navigator.appVersion.match(/MSIE/))?16:4;var i=(h>0)?j:-j;var k=Math.round(h/i);var a=function(){b(".modal-content").scrollTop(b(".modal-content").scrollTop()+i);if(--k){setTimeout(a,0)}};if(k){a()}},checkboxHandler:function(a){var d=b(a.target);if(d.is(this.modalCbAll)){this.toggleAllCbs(!d.prop("checked"));this.modalToggleAll.prop("checked",false)}else{if(!d.is(this.modalToggleAll)&&d.prop("checked")&&this.modalCbAll.length&&this.modalCbAll.prop("checked")){this.toggleAllItem(false)}else{if(d.is(this.modalToggleAll)){this.toggleAllCbs(d.prop("checked"))}else{if(this.modalToggleAll.length){this.modalToggleAll.prop("checked",false);if(!this.modalCheckboxes.not(this.modalCbAll).is(":checked")){this.toggleAllItem(true)}}}}}},toggleAllItem:function(a){this.modalCbAll.prop("checked",a).prop("disabled",a);this.modalCbHidden.val(a?this.modalCbAll.val():"")},toggleAllCbs:function(a){this.modalCheckboxes.not(this.modalCbAll).prop("checked",a);this.toggleAllItem(!a)},sortByHits:function(a){this.sortList(a,"Hits")},sortByName:function(a){this.sortList(a,"Name")},sortList:function(a,i){a.preventDefault();a.stopPropagation();var h=b(a.target);var j=h.parents(".evt-sort").find("input.panelSort");var g=h.parents(".evt-sort").find("input.panelSortOrder");if(j.length){if(j.val()===i){g.val((g.val()==="Desc")?"Asc":"Desc")}else{g.val("")}j.val(i);this.getSortedList("/ExpandedPanel")}},getSortedList:function(e){this.markupUrl=ep.utilities.replaceEPCommand(this.command+e);var f;var a=jQuery("#modalPanelForm");if(a.length){this.updateMethod="post";f=a.serialize()}this.containerId="modal";this.update(f);this.updateMethod="get"},onUpdate:function(){this.onModalLoad()}},"ep.base.ModuleController")})})(jQuery);(function(e){var h;function f(a){var b=ep.utilities.buildAjaxRequestPath("BreadBox/Toggle");e.ajax({type:"get",url:b,data:{theIsExpanded:a}})}e(document).ready(function g(a){ep.getInstance("ep.utilities");h=e("#breadbox");if(!h.length){ep.debug("BreadBoxContainer does not exist in the DOM.  Exiting");return}h.find(".collapse-toggle").each(function(d,c){var b=jQuery(this).hasClass("active");e(c).bind("click",function(j){b=!b;f(b)})})})})(jQuery);(function(b){ep.registerInstance("ep.controller.page.ehost.ResultListController","ep.base.ResultListController",{createAlertRssLink:null,onDomLoad:function(){this.createAlertRssLink=b("#lnkAlert");this.setEvents();this.initControls();if(ep.clientData.restrictedElements){ep.getInstance({epId:"ep.controller.GuestLoginController",restrictedElements:ep.clientData.restrictedElements})}if(b("#addThis").length&&ep.clientData.addThis){var f=b.browser.msie,a=parseInt(b.browser.version,10),e=(f&&(a<=8))?true:false;ep.require(ep.clientData.addThis.widgetUrl,function(){if(e&&addthis_config){addthis_config.ui_click=false}setTimeout(function(){addthis.init()},500)})}ep.controller.control.OptionsControlsDropdowns.init();ep.utilities.runQueryStringMethod()},onUnLoad:function(){this.unSetEvents()},initControls:function(){if(b("#DocTypeContainer").length){ep.require("ep/controller/control/doctypecontrol.js")}else{if(b("#multiSelectDocType").length){ep.registerInstance("ep.controller.control.resultlist.SelectMultipleDocTypeController","ep.base.SelectMultipleController",{panelElement:"multiSelectDocType",command:"MultiSelectDocType",messages:this.panelMessages});ep.require("ep/controller/control/doctypecontrol.js")}}if(b("#DbFilterContainer").length){ep.require("ep/controller/control/resultlist/dbfiltercontrol.js")}else{if(b("#multiSelectDbFilter").length){ep.registerInstance("ep.controller.control.resultlist.MultiSelectDbFilterController","ep.base.SelectMultipleController",{panelElement:"multiSelectDbFilter",command:"MultiSelectDbFilter",messages:this.panelMessages});ep.require("ep/controller/control/resultlist/dbfiltercontrol.js")}}_clusterContainer=b("#multiSelectClusterContainer");if(_clusterContainer.length){_clusterContainer.find(".multiSelectPanel").each(b.proxy(function(a,d){ep.registerInstance("ep.controller.control.resultlist.MultiSelectClusterController","ep.base.SelectMultipleController",{panelElement:d.id,command:"MultiSelectCluster",messages:this.panelMessages})},this))}if(b("#integratedSearchControl").length){ep.registerInstance("ep.controller.control.resultlist.ModalEhisPanelController","ep.base.ModalPanelController",{showCloseButton:false,panelElement:"integratedSearchControl",messages:this.panelMessages})}if(b("#resultsLimiterControl").length&&ep.clientData.modalPanelsEnabled){ep.registerInstance("ep.controller.control.resultlist.ModalResultsLimiterPanelController","ep.base.SliderPanelController",{panelElement:"resultsLimiterControl",messages:this.panelMessages})}if(b("#column1").length){ep.getInstance({epId:"ep.controller.CollapsibleController",page:"results"})}if(b("#breadbox").length){ep.require("ep/controller/control/breadboxcontrol.js")}if(ep.clientData.isShowAddFolderPopup){ep.require("ep/controller/control/addtofolderpopup.js")}},setEvents:function(){this.setAddToFolderPopupEvents(false);this.setClickEvents(false);this.setSearchHistoryEvents(false)},unSetEvents:function(){this.setAddToFolderPopupEvents(true);this.setClickEvents(true);this.setSearchHistoryEvents(true)},setAddToFolderPopupEvents:function(k){var g=b.proxy(this.handlers.addToFolderPopupLinkClick,this);function a(c){g(c,c.data,true)}function h(c){g(c,c.data,false)}if(ep.clientData.isShowAddFolderPopup){b('a[id^="add_"]').each(function(){var c=b(this).data("folder").resultID;b(this).attr("onclick","");b(this).attr("href","#");b(this)[k?"unbind":"bind"]("click",c,a)});b('a[id^="added_"]').each(function(){var c=b(this).data("folder").resultID;b(this).attr("onclick","");b(this).attr("href","#");b(this)[k?"unbind":"bind"]("click",c,h)});var j=b("#lnkAddAll").first();if(j.length){j.attr("onclick","");j.attr("href","#");j[k?"unbind":"bind"]("click",b.proxy(this.handlers.addMultiToFolderPopupLinkClick,this))}}},setSearchHistoryEvents:function(q){var o=b.proxy(this.handlers.showEditSearchHistoryModalClick,this);function a(c){o(c,c.data.SearchId)}var m=b(".saveSearchLink").first();if(m.length){m[q?"unbind":"bind"]("click",b.proxy(this.handlers.saveSelectedSearches,this))}var p=b(".printSearchLink").first();if(p.length){p[q?"unbind":"bind"]("click",b.proxy(this.handlers.printSelectedSearches,this))}var k=b("#tblSearchHistory");var l;var n;if(k.length&&ep.clientData.isShowEditHistoryModal){l=k.find(".editSearch");for(i=0;i<l.length;i++){aElement=b(l[i]).children().first();n=b(l[i]).parent().siblings(".searchID").children().first().html();if(aElement.length&&n){aElement[q?"unbind":"bind"]("click",{SearchId:n},a)}}}},setClickEvents:function(a){if(this.createAlertRssLink.length){this.createAlertRssLink[a?"unbind":"bind"]("click",this.handlers.createAlertModalClick)}},handlers:{createAlertModalPopupLinkClick:b.proxy(function(d){d.preventDefault();var a=ep.getInstance({epId:"ep.controller.control.AlertModalModule"});if(a){a.showModal()}ep.dialog.ToggledPopup.closeDialog()},this),createAlertModalClick:b.proxy(function(d){d.preventDefault();var a=ep.getInstance({epId:"ep.controller.control.AlertModalModule"});if(a){a.showModal()}ep.dialog.ToggledPopup.closeDialog()},this),saveSelectedSearches:function(f){f.preventDefault();var a="searchhistory/SaveSelectedSearches";var g="";for(var h=1;b("#searchHistoryCheckBox_S"+h).length;h++){if(b("#searchHistoryCheckBox_S"+h).is(":checked")){g+="S"+h+","}}window.location=ep.utilities.replaceEPCommand(a)+"&theSearchHistoryIds="+g},printSelectedSearches:function(g){g.preventDefault();var a="searchhistory/PrintSearchHistory";var j="";for(var k=1;b("#searchHistoryCheckBox_S"+k).length;k++){if(b("#searchHistoryCheckBox_S"+k).is(":checked")){j+="S"+k+","}}var h=ep.utilities.replaceEPCommand(a);openprintSearchHistory(h+"&theSearchHistoryIds="+j)},showEditSearchHistoryModalClick:function(e,f){e.preventDefault();var a=ep.getInstance({epId:"ep.controller.control.EditSearchHistoryModalModule",params:{theSearchHistory:f}});if(a){a.showModal({theSearchHistory:f})}},addToFolderPopupLinkClick:function(f,e,a){f.preventDefault();ep.controller.control.AddToFolderPopup.showAddToFolderPopup(f,{theResultId:e,theIsResultList:true,theIsToggleIcon:a})},addMultiToFolderPopupLinkClick:function(a){a.preventDefault();ep.controller.control.AddToFolderPopup.showAddToFolderPopup(a,{theIsMulti:true,theIsResultList:true})}}})})(jQuery);ep.register("ep.controller.control.BookJackets");ep.controller.control.BookJackets=(function(h){function e(c,a){var b=h(a);var d=b.data("book-jacket");if(d&&d.ThumbImageUrl&&d.ThumbImageUrl.length>0){h("<img />").load(function(){if(this.width>1||this.naturalWidth>1){b.prepend(h(this));h(this).wrapAll('<span class="bj-img"></span>');b.removeClass();if(d.Type===3){b.addClass("book-jacket-series")}else{b.addClass("book-jacket")}}else{h(this).remove()}}).attr({src:d.ThumbImageUrl,alt:d.ToolTip})}}function g(c,a){var b=h(a);var d=b.data("book-jacket");if(d&&d.ThumbImageUrl&&d.ThumbImageUrl.length>0){h("<img />").load(function(){if(this.width>1||this.naturalWidth>1){b.prepend(h(this));h(".pubtype-icon",b).remove();if(h.browser.msie){h(this).removeAttr("height").removeAttr("width")}h(this).attr("width","60px");h(this).attr("data-auto","book_jacket");b.removeClass("pubtype");if(d.Type===3){b.addClass("book-jacket-series")}else{b.addClass("book-jacket")}}else{h(this).remove()}}).attr({src:d.ThumbImageUrl,alt:d.ToolTip})}}function f(c,a){var b=h(a);var d=b.data("book-jacket");if(d&&d.ThumbImageUrl&&d.ThumbImageUrl.length>0){h("<img />").load(function(){if(this.width>1||this.naturalWidth>1){b.prepend(h(this));if(d.DetailImageUrl!==null&&h.trim(d.DetailImageUrl).length>0){h(this).wrapAll('<a href="'+d.DetailImageUrl+'" target="_blank"></a>')}if(h.browser.msie){h(this).removeAttr("height").removeAttr("width")}}else{h(this).remove()}}).attr({src:d.ThumbImageUrl,alt:d.ToolTip})}}return{loadResultBookJacketForMobile:function(a){h(a).find(".mobile-jacket[data-book-jacket]").each(e)},loadResultBookJacket:function(){h(".record-icon[data-book-jacket]").each(g)},loadDetailBookJacket:function(){h("#bookJacket[data-book-jacket]").each(f)},loadMobileResultBookJacket:function(){h(".mobile-jacket[data-book-jacket]").each(e)}}})(jQuery);(function(b){b(function(){ep.controller.control.BookJackets.loadDetailBookJacket();ep.controller.control.BookJackets.loadResultBookJacket();ep.controller.control.BookJackets.loadMobileResultBookJacket()})})(jQuery);